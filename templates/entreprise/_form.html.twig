<style type="text/css">
    #entreprise_gestionLotChantier{
        margin: 0;
        margin-right: 4px;
        width: 17px;
        height: 20px;
    }
</style>

{{ form_start(form, {'attr': {'class': 'formEntreprise', 'autocomplete': 'off'}}) }}
<div class="row">
    <div class="col-lg-12 form-group">
        {{ form_label(form.type, 'Type') }}
        {{ form_row(form.type) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.code, 'Code') }}
        {{ form_row(form.code) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.name, 'Nom') }}
        {{ form_row(form.name) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.address, 'Adresse') }}
        {{ form_row(form.address) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.city, 'Ville') }}
        {{ form_row(form.city) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.cp, 'Code Postal') }}
        {{ form_row(form.cp) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.email, 'E-mail') }}
        {{ form_row(form.email) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.phone, 'Téléphone') }}
        {{ form_row(form.phone) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.siret, 'Siret') }}
        {{ form_row(form.siret) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.tva, 'Code TVA') }}
        {{ form_row(form.tva) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.ape, 'Code APE') }}
        {{ form_row(form.ape) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.website, 'Site Internet') }}
        {{ form_row(form.website) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.fax, 'Fax') }}
        {{ form_row(form.fax) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.bank, 'Nom de votre banque') }}
        {{ form_row(form.bank) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.rib, 'RIB') }}
        {% if entreprise.logo is not empty %}
        <a href="{{ asset('/rib/'~ entreprise.rib) }}">Télécharger un rib</a>
        {% endif %}
        {{ form_row(form.rib) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.logo, 'Logo') }}
        {% if entreprise.logo is not empty %}
            <br>
        <img style="width: 100px" src="{{ asset('/logo/'~ entreprise.logo) }}" alt="{{ entreprise.name }}">
        {% endif %}
        {{ form_row(form.logo) }}
    </div>    

    <div class="col-lg-12 form-group">
        {{ form_label(form.logo_facture, 'Logo Facture') }}
        {% if entreprise.logoFacture is not empty %}
            <br>
        <img style="width: 100px" src="{{ asset('/logo/'~ entreprise.logoFacture) }}" alt="{{ entreprise.name }}">
        {% endif %}
        {{ form_row(form.logo_facture) }}
    </div>

    <div class="col-lg-12 form-group">
        {{ form_label(form.director, 'Directeur') }}
        {{ form_row(form.director) }}
    </div>
    <div class="col-lg-12 form-group">
        {{ form_label(form.phone_director, 'Téléphone du directeur') }}
        {{ form_row(form.phone_director) }}
    </div>
    <div class="col-lg-6 form-group">
        {{ form_label(form.sender_mail, "Email d'envoie ou d'expedition") }}
        {{ form_row(form.sender_mail) }}
    </div>
    <div class="col-lg-6 form-group">
        {{ form_label(form.sender_name, "Nom d'envoie d email") }}
        {{ form_row(form.sender_name) }}
    </div>
</div>

<div class="row" style="display: flex; align-items: center;">
    <div>
        <div class="col-lg-6 form-group">
            <label>Email Serveur mail</label>
            <input  type="email" name="username" class="form-control" value="{{ emailServeurMail is defined and emailServeurMail is not null ? emailServeurMail.value : '' }}">
        </div>
        <div class="col-lg-6 form-group">
            <label>Mot de passe Serveur mail</label> 
            <input type="text" name="password" class="form-control" value="{{ passwordServeurMail is defined and passwordServeurMail is not null ? passwordServeurMail.value : '' }}">
        </div>
        <div class="col-lg-6 form-group">
            <label>Hote Serveur mail</label>
            <input type="text" name="hote" class="form-control" value="{{ hoteServeurMail is defined and hoteServeurMail is not null ? hoteServeurMail.value : '' }}">
        </div>
        <div class="col-lg-6 form-group">
            <label>Port Serveur mail</label>
            <input type="text" name="port" class="form-control" value="{{ portServeurMail is defined and portServeurMail is not null ? portServeurMail.value : '' }}">
        </div>
    </div>
</div>

<div class="col-lg-12 form-group">
    <div style="display: flex;align-items: center;">
        {{ form_row(form.gestionLotChantier) }} 
        <label for="entreprise_gestionLotChantier">Gestion des lots et chantiers</label>
    </div>
</div>


{% if entreprise.id is not null %}
<br><br>
<div class="row">
    <h4 class="col-lg-12 form-title">GARRAGE</h4>
    <div class="col-lg-12">
        <div class="garrage-container">
            {% for garrage in garrages %}
                <div class="garrage-content">
                    <div class="col-lg-11 form-group">   
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="row" style="margin-top: 20px;">
                                    <div class="col-lg-6">
                                        <label>Nom du garrage</label>
                                        <div class="form-group">
                                            <input type="text" class="form-control" name="garragesEdit[{{garrage.id}}][nom]" value="{{garrage.nom}}" required>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <label>Numéro</label>
                                        <div class="form-group"><input type="text" class="form-control" name="garragesEdit[{{garrage.id}}][numero]" value="{{garrage.numero}}" required></div>
                                    </div>
                                </div>
                            </div>
                        </div>      
                    </div>
                    <span class="close-garrage btn col-lg-1" style="color: #b50505;">X</span>
                </div>
            {% endfor %}
        </div>

        <div class="col-lg-12 text-center" style="margin-top: 34px;">
            <span class="btn" onclick="addGarrage()" style="border: 1px solid #f1efef;font-size: 15px;color: #000;"><i class="fas fa-plus-circle"></i> Ajouter un garrage</span>
        </div>
    </div>
</div>
<br><br>
{% endif %}

<div class="" style="display: flex;">
    <button class="btn btn-primary">{{ button_label|default('Enregistrer') }}</button>
    {% if entreprise.id is not null %}
    <button style="margin-left: 12px;" type="submit" name="tester_connexion" value="Tester" class="btn btn-primary">Enregistrer et Tester</button>
    {% endif %}
</div>


{{ form_end(form) }}

<script type="text/javascript">
    $(document).ready(function() {
      $(document).on("keydown", "form[name=entreprise]", function(event) { 
        if(event.keyCode == 13) {
          event.preventDefault();
          return false;
        }
      });
    });

    {% if entreprise.id is not null %}
        addGarrage = function(){
            var ELT = '<div class="garrage-content">'+
                        '<div class="col-lg-11 form-group">'+
                            '<div class="row">'+
                                '<div class="col-lg-12">'+
                                    '<div class="row">'+
                                        '<div class="col-lg-6">'+
                                            '<label>Nom du Garrage</label>'+
                                            '<input type="text" name="garrages[nom][]" class="form-control" required>'+
                                        '</div>'+
                                        '<div class="col-lg-6">'+
                                            '<label>Numéro</label>'+
                                            '<div><input type="text" name="garrages[numero][]" class="form-control" required></div>'+
                                        '</div>'+
                                    '</div>'+
                                '</div>'+
                            '</div>'+                   
                        '</div>'+
                        '<span class="close-garrage btn col-lg-1" style="color: #b50505;">X</span>'+
                    '</div>';
            $('.garrage-container').append(ELT);
        }

        $(document).on('click', '.close-garrage', function(){
            $(this).parent().remove();
        })
    {% endif %}
    
</script>